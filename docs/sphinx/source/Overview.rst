Overview
========

This section provides an overview of LVM-DAP usage and the main CLI commands.

lvm-dap-conf
------------

The primary command for spectral fitting using YAML configuration files.

**Syntax:**

.. code-block:: bash

    lvm-dap-conf [-h] [-d] lvm_file label config_yaml

**Arguments:**

* ``lvm_file`` - FITS file in LVM format
* ``label`` - Label for the current run
* ``config_yaml`` - Configuration file for fitting parameters

**Example:**

.. code-block:: bash

    lvm-dap-conf _examples/data/lvmSFrame-example.fits.gz dap-example _legacy/lvm-dap_fast.yaml

YAML Configuration
~~~~~~~~~~~~~~~~~~

The YAML configuration file controls all fitting parameters. Key sections include:

.. code-block:: yaml

    # Output and paths
    output_path: "/path/to/output/"
    lvmdap_dir: "/path/to/lvmdap"
    rsp-file: "path/to/stellar-templates.fits.gz"
    rsp-nl-file: "path/to/stellar-templates.fits.gz"

    # Instrumental parameters
    sigma-inst: 1  # Instrumental resolution in Angstroms

    # Non-linear parameter ranges: [guess, delta, min, max]
    redshift:
      - 0.0      # guess
      - 0.0001   # delta
      - -0.0003  # min
      - 0.0003   # max

    sigma:       # Velocity dispersion in km/s
      - 1        # guess
      - 5        # delta
      - 1        # min
      - 15       # max

    AV:          # Dust extinction in V-band
      - 0        # guess
      - 0.3      # delta
      - 0.0      # min
      - 1.5      # max

    # Wavelength ranges
    w-range:
      - 3700
      - 9500
    w-range-nl:
      - 3800
      - 4200

    # Additional files
    emission-lines-file: path/to/emission_lines.LVM
    mask-file: path/to/mask_bands.txt
    config-file: path/to/auto_ssp.config

    # Processing options
    do_plots: 1
    only-integrated: True
    auto-redshift: True

lvm-dap-gen-out-mod
-------------------

Generates output models from fitted data.

**Syntax:**

.. code-block:: bash

    lvm-dap-gen-out-mod [-h] [-d] [-output_path OUTPUT_PATH] [--plot PLOT]
                        [--flux-scale min max] lvm_file DAP_table_in label config_yaml

**Arguments:**

* ``lvm_file`` - Input LVM spectrum that was fitted
* ``DAP_table_in`` - DAP file generated by LVM-DAP fitting
* ``label`` - Label for the output file
* ``config_yaml`` - Configuration file with fitting parameters

**Options:**

* ``-d, --debug`` - Enable debugging mode
* ``-output_path`` - Directory to store results
* ``--plot`` - Plot output (0=no, 1=display, 2=save only)
* ``--flux-scale`` - Flux scale range for input spectrum

lvm-dap-sim
-----------

Simulates spectral data based on fitted parameters.

**Syntax:**

.. code-block:: bash

    lvm-dap-sim [-h] [-n_sim N] [-n_st N] [-f_st F] [-f_el F]
                [-dap_fwhm F] [-d] lvm_file label config_yaml

**Arguments:**

* ``lvm_file`` - Input LVM spectrum for simulation
* ``label`` - Label for the current run
* ``config_yaml`` - Configuration file

**Options:**

* ``-n_sim`` - Number of simulated spectra (default: 10)
* ``-n_st`` - Number of stars in model (default: 10)
* ``-f_st`` - Scaling factor for stellar spectra (default: 1.0)
* ``-f_el`` - Scaling factor for emission lines (default: 1.0)
* ``-dap_fwhm`` - Scaling factor for emission line dispersion (default: 2.354)

lvm-dap (Deprecated)
--------------------

.. warning::

    This command is deprecated. Use ``lvm-dap-conf``, ``lvm-dap-gen-out-mod``,
    or ``lvm-dap-sim`` instead.

**Syntax:**

.. code-block:: bash

    lvm-dap [-h] [--config-file CONFIG_FILE] spectrum-file rsp-file sigma-inst label
